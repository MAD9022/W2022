<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>5.2 TMDB API, Fetch, and Security | MAD9022</title>
    <meta name="generator" content="VuePress 1.9.5">
    
    <meta name="description" content="Fullstack: Frontend Development Course">
    
    <link rel="preload" href="/W2022/assets/css/0.styles.e8f982fe.css" as="style"><link rel="preload" href="/W2022/assets/js/app.86fc79ff.js" as="script"><link rel="preload" href="/W2022/assets/js/2.644458f3.js" as="script"><link rel="preload" href="/W2022/assets/js/42.241ccad7.js" as="script"><link rel="preload" href="/W2022/assets/js/8.c8690475.js" as="script"><link rel="preload" href="/W2022/assets/js/10.e0709425.js" as="script"><link rel="prefetch" href="/W2022/assets/js/11.03dd7ca9.js"><link rel="prefetch" href="/W2022/assets/js/12.099d5a86.js"><link rel="prefetch" href="/W2022/assets/js/13.2bd6007b.js"><link rel="prefetch" href="/W2022/assets/js/14.e0a43227.js"><link rel="prefetch" href="/W2022/assets/js/15.092d6948.js"><link rel="prefetch" href="/W2022/assets/js/16.859f074a.js"><link rel="prefetch" href="/W2022/assets/js/17.75c09ace.js"><link rel="prefetch" href="/W2022/assets/js/18.a6e526dd.js"><link rel="prefetch" href="/W2022/assets/js/19.bb7ee112.js"><link rel="prefetch" href="/W2022/assets/js/20.97f8b97a.js"><link rel="prefetch" href="/W2022/assets/js/21.23d3ef6f.js"><link rel="prefetch" href="/W2022/assets/js/22.933a5f9c.js"><link rel="prefetch" href="/W2022/assets/js/23.4a816fa9.js"><link rel="prefetch" href="/W2022/assets/js/24.4b4b432d.js"><link rel="prefetch" href="/W2022/assets/js/25.cd556980.js"><link rel="prefetch" href="/W2022/assets/js/26.ba97292d.js"><link rel="prefetch" href="/W2022/assets/js/27.cd63cd1f.js"><link rel="prefetch" href="/W2022/assets/js/28.7c415eed.js"><link rel="prefetch" href="/W2022/assets/js/29.cfd0de32.js"><link rel="prefetch" href="/W2022/assets/js/3.bca6a9a1.js"><link rel="prefetch" href="/W2022/assets/js/30.914c8d51.js"><link rel="prefetch" href="/W2022/assets/js/31.7bc52ca8.js"><link rel="prefetch" href="/W2022/assets/js/32.e7e81d1c.js"><link rel="prefetch" href="/W2022/assets/js/33.b0178163.js"><link rel="prefetch" href="/W2022/assets/js/34.849cc443.js"><link rel="prefetch" href="/W2022/assets/js/35.37fdb7ab.js"><link rel="prefetch" href="/W2022/assets/js/36.0c0d987a.js"><link rel="prefetch" href="/W2022/assets/js/37.be9d0dcc.js"><link rel="prefetch" href="/W2022/assets/js/38.1c08ef56.js"><link rel="prefetch" href="/W2022/assets/js/39.10bff2ae.js"><link rel="prefetch" href="/W2022/assets/js/4.e2498dd6.js"><link rel="prefetch" href="/W2022/assets/js/40.8fe54bd5.js"><link rel="prefetch" href="/W2022/assets/js/41.42838ccb.js"><link rel="prefetch" href="/W2022/assets/js/43.458ecccd.js"><link rel="prefetch" href="/W2022/assets/js/44.07fdfe33.js"><link rel="prefetch" href="/W2022/assets/js/45.2da207c2.js"><link rel="prefetch" href="/W2022/assets/js/46.51fffa86.js"><link rel="prefetch" href="/W2022/assets/js/47.65aed37a.js"><link rel="prefetch" href="/W2022/assets/js/5.02d60a9c.js"><link rel="prefetch" href="/W2022/assets/js/6.40785f8b.js"><link rel="prefetch" href="/W2022/assets/js/7.c2b7ff19.js"><link rel="prefetch" href="/W2022/assets/js/9.ec48c5f9.js">
    <link rel="stylesheet" href="/W2022/assets/css/0.styles.e8f982fe.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/W2022/" class="home-link router-link-active"><!----> <span class="site-name">MAD9022</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/W2022/overview/" class="nav-link">
  Overview
</a></div><div class="nav-item"><a href="/W2022/assignments/" class="nav-link">
  Deliverables
</a></div><div class="nav-item"><a href="/W2022/resources/" class="nav-link">
  Resources
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/W2022/overview/" class="nav-link">
  Overview
</a></div><div class="nav-item"><a href="/W2022/assignments/" class="nav-link">
  Deliverables
</a></div><div class="nav-item"><a href="/W2022/resources/" class="nav-link">
  Resources
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Introduction</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Content Modules</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/W2022/modules/week1/file-formats/" class="sidebar-link">1.1: File Formats</a></li><li><a href="/W2022/modules/week1/data-structures/" class="sidebar-link">1.2: Data Structures</a></li><li><a href="/W2022/modules/week2/cookie-webstorage/" class="sidebar-link">2.1: Cookies, LocalStorage, Cache</a></li><li><a href="/W2022/modules/week2/indexeddb/" class="sidebar-link">2.2: IndexedDB</a></li><li><a href="/W2022/modules/week3/code-organizing/" class="sidebar-link">3.1: ES Modules</a></li><li><a href="/W2022/modules/week3/continuous-delivery/" class="sidebar-link">3.2: Github and Netlify</a></li><li><a href="/W2022/modules/week4/web-workers/" class="sidebar-link">4.1: Asynchronous Code &amp; Workers</a></li><li><a href="/W2022/modules/week4/service-workers/" class="sidebar-link">4.2: Service Workers</a></li><li><a href="/W2022/modules/week5/manifest-install/" class="sidebar-link">5.1: Web Manifests and PWA Installs</a></li><li><a href="/W2022/modules/week5/api-fetch/" aria-current="page" class="active sidebar-link">5.2: APIs and Fetch</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/W2022/modules/week5/api-fetch/#the-movie-db-review" class="sidebar-link">The Movie DB Review</a></li><li class="sidebar-sub-header"><a href="/W2022/modules/week5/api-fetch/#fetch-api-beyond-the-basics" class="sidebar-link">Fetch API Beyond the Basics</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/W2022/modules/week5/api-fetch/#request-objects" class="sidebar-link">Request Objects</a></li><li class="sidebar-sub-header"><a href="/W2022/modules/week5/api-fetch/#response-objects" class="sidebar-link">Response Objects</a></li><li class="sidebar-sub-header"><a href="/W2022/modules/week5/api-fetch/#body-objects" class="sidebar-link">Body Objects</a></li><li class="sidebar-sub-header"><a href="/W2022/modules/week5/api-fetch/#json-text-and-blob-methods" class="sidebar-link">json(), text(), and blob() Methods</a></li><li class="sidebar-sub-header"><a href="/W2022/modules/week5/api-fetch/#header-objects" class="sidebar-link">Header Objects</a></li><li class="sidebar-sub-header"><a href="/W2022/modules/week5/api-fetch/#url-and-location-objects" class="sidebar-link">URL and Location Objects</a></li><li class="sidebar-sub-header"><a href="/W2022/modules/week5/api-fetch/#formdata-objects" class="sidebar-link">FormData Objects</a></li><li class="sidebar-sub-header"><a href="/W2022/modules/week5/api-fetch/#urlsearchparams" class="sidebar-link">URLSearchParams</a></li><li class="sidebar-sub-header"><a href="/W2022/modules/week5/api-fetch/#usvstring" class="sidebar-link">USVString</a></li></ul></li><li class="sidebar-sub-header"><a href="/W2022/modules/week5/api-fetch/#fetch-all-together" class="sidebar-link">Fetch All Together</a></li><li class="sidebar-sub-header"><a href="/W2022/modules/week5/api-fetch/#cors" class="sidebar-link">CORS</a></li><li class="sidebar-sub-header"><a href="/W2022/modules/week5/api-fetch/#content-security-policies" class="sidebar-link">Content-Security-Policies</a></li><li class="sidebar-sub-header"><a href="/W2022/modules/week5/api-fetch/#authentication-and-jwt" class="sidebar-link">Authentication and JWT</a></li><li class="sidebar-sub-header"><a href="/W2022/modules/week5/api-fetch/#what-to-do-this-week" class="sidebar-link">What to do this week</a></li></ul></li><li><a href="/W2022/modules/week6/caching/" class="sidebar-link">6.1: Offline First and Audits</a></li><li><a href="/W2022/modules/week6/install-native/" class="sidebar-link">6.2: More PWA Stuff</a></li><li><a href="/W2022/modules/week7/pwa-project/" class="sidebar-link">7.2: PWA Project</a></li><li><a href="/W2022/modules/reading/" class="sidebar-link">Reading Week</a></li><li><a href="/W2022/modules/week9/flutter-setup/" class="sidebar-link">9.1: Flutter Setup</a></li><li><a href="/W2022/modules/week9/flutter-intro/" class="sidebar-link">9.2: Flutter Intro</a></li><li><a href="/W2022/modules/week10/colors-assets/" class="sidebar-link">10.1: Using Colors and Assets in Widgets</a></li><li><a href="/W2022/modules/week10/layout-widgets/" class="sidebar-link">10.2: Flutter Layout and Widgets</a></li><li><a href="/W2022/modules/week11/navigation/" class="sidebar-link">11.1: Flutter Navigation</a></li><li><a href="/W2022/modules/week11/stateful/" class="sidebar-link">11.2: Stateful Widgets</a></li><li><a href="/W2022/modules/week12/api-1/" class="sidebar-link">12.1: Flutter API Calls I</a></li><li><a href="/W2022/modules/week12/api-2/" class="sidebar-link">12.2: Flutter API Calls II</a></li><li><a href="/W2022/modules/week13/data-persistence/" class="sidebar-link">13.1: Shared Preferences</a></li><li><a href="/W2022/modules/week13/themes/" class="sidebar-link">13.2: Themes, Splash Screens, More</a></li><li><a href="/W2022/modules/week14/" class="sidebar-link">14: Gestures, Dismissable, More</a></li><li><a href="/W2022/modules/week15/" class="sidebar-link">15: Final Project</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Deliverables</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><header><div class="section-title blue">
    Progressive Web Apps
  </div> <h1>5.2 TMDB API, Fetch, and Security</h1></header> <h2 id="the-movie-db-review"><a href="#the-movie-db-review" class="header-anchor">#</a> The Movie DB Review</h2> <p><a href="https://developers.themoviedb.org/3" target="_blank" rel="noopener noreferrer">TMBD API<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> was something that you used last semester. It is the API that can be used to find information on TV Shows and Movies through <code>fetch</code> calls.</p> <p>We are using version 3 of the API. It requires that you register for a key. You should already have a key from the first semester. You can log in to the site or use the forgot password feature to reset your password and login. Then you will be able to go to <a href="https://www.themoviedb.org/settings/api" target="_blank" rel="noopener noreferrer">your account page<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and get your key.</p> <p>There are many different endpoints that you can use to search for different things.</p> <p>All API calls begin with the url <code>https://api.themoviedb.org/3</code> and then add the different end points.</p> <p>They all need parameters to be passed through the query string as part of the URL too. Your key needs to be used on every call, like this <code>?api_key=thiswouldbeyourapikey</code>.</p> <p>As an example, if you wanted to search for an actor, you would do a <code>fetch</code> call to the <code>/search/person</code> end point, as detailed <a href="https://developers.themoviedb.org/3/search/search-people" target="_blank" rel="noopener noreferrer">in the documentation for the /search/person endpoint<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token constant">BASE</span> <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">https://api.themoviedb.org/3</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token keyword">const</span> searchPeople <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/search/person</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">APIKEY</span> <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">thiswouldbeyourapikey</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

<span class="token comment">//do a search for actors whose name includes `emilia`</span>
<span class="token keyword">let</span> name <span class="token operator">=</span> <span class="token string">'emilia'</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> url <span class="token operator">=</span> <span class="token constant">BASE</span> <span class="token operator">+</span> searchPeople <span class="token operator">+</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">?api_key=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">APIKEY</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&amp;query=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

<span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resp</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>resp<span class="token punctuation">.</span>ok<span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>resp<span class="token punctuation">.</span>statusText<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> resp<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">content</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">//content is your javascript object back from the api</span>
    <span class="token comment">//there will be a property called results that will hold an array of matches</span>
    content<span class="token punctuation">.</span>results<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">actor</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>actor<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//output each matching actor Object in the console</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">//display something about the error for the user</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>Depending on the API call that you make, you will get different response objects with different properties. However, nearly all of them have a top level property called <code>results</code> that will be an array of matches to your query.</p> <h4 id="handling-images"><a href="#handling-images" class="header-anchor">#</a> Handling Images</h4> <p>Movies, TV shows, and actors will nearly all have images that can be displayed. Often there will be multiple sizes of images. <a href="https://developers.themoviedb.org/3/getting-started/images" target="_blank" rel="noopener noreferrer">Image reference<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>The base URL for all images is <code>https://image.tmdb.org/t/p</code>. After the base value there will be a folder that indicates the image size. It will be something like <code>/w500</code> for images that are 500px wide. The final part will be a property that includes <code>path</code> as part of the name. <code>poster_path</code> or <code>background_path</code> are common property names for the image. Different types of image paths have different sizes available. Reference the list below to see the options.</p> <p>In the end you will end up with a URL like <code>https://image.tmdb.org/t/p/w500/kqjL17yufvn9OVLyXYpvtyrFfak.jpg</code>.</p> <p>To get the list of sizes and the different possible URL parts for images you can make a call to the configuration endpoint - <code>https://api.themoviedb.org/3/configuration?api_key=&lt;&lt;api_key&gt;&gt;</code>. Here is what it will return.</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;images&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;base_url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://image.tmdb.org/t/p/&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;secure_base_url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://image.tmdb.org/t/p/&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;backdrop_sizes&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;w300&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;w780&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;w1280&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;original&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;logo_sizes&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;w45&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;w92&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;w154&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;w185&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;w300&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;w500&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;original&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;poster_sizes&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;w92&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;w154&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;w185&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;w342&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;w500&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;w780&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;original&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;profile_sizes&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;w45&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;w185&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;h632&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;original&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;still_sizes&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;w92&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;w185&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;w300&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;original&quot;</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><div title="tmdb tutorial" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/bpHtxx_wmqw" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; fullscreen" allowfullscreen="allowfullscreen"></iframe></div> <p>Need to know more about template strings?</p> <div title="template strings" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/9SapCazLWpw" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; fullscreen" allowfullscreen="allowfullscreen"></iframe></div> <div title="Tagged Template Literals" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/4oVJVglLLns" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; fullscreen" allowfullscreen="allowfullscreen"></iframe></div> <p>Need to know more about Error objects and throwing Errors?</p> <div title="try catch throw" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/_am9rKw4vWw" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; fullscreen" allowfullscreen="allowfullscreen"></iframe></div> <div title="handling errors in promises" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/LzlGL3k3p04" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; fullscreen" allowfullscreen="allowfullscreen"></iframe></div> <h2 id="fetch-api-beyond-the-basics"><a href="#fetch-api-beyond-the-basics" class="header-anchor">#</a> Fetch API Beyond the Basics</h2> <p>When you make <code>fetch</code> calls to the server it becomes important to understand exactly what you are doing and how all the parts fit together. The aim of this section is to give you a wider perspective about how all the parts fit together.</p> <p>Originally API calls to the server were accomplished with a thing called <code>XMLHttpRequest</code> that was introduced in Internet Explorer 5.5. It was a way to fetch XML documents from the server. Which lead to the coining of the term <code>AJAX</code> - Asynchronous JavaScript And Xml in 2005, to describe this approach to client side web development.</p> <p>It was the driving technology behind the rise of Google Maps. Combined with the ability to drag elements on the screen, google maps could load new locations and get new map tiles without every having to reload the whole page. MapQuest was the first big online mapping site. They had 8 buttons around the map and you had to click the button for the direction you wanted to move and then wait for the whole page to reload.</p> <p>XMLHttpRequest is still supported in all browsers and is part of some libraries. It's good to be familiar with it. Here is a video about how to use it to make AJAX calls</p> <div title="xmlhttprequest" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/mLL5pdIbqWc" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; fullscreen" allowfullscreen="allowfullscreen"></iframe></div> <p><code>fetch</code> was developed as an enhanced and more secure way to pass things between the client and the server. It was based on <code>Promises</code>. The <code>Fetch API</code> included access to all the component parts of the request and response.</p> <p><code>HTTP</code> is a protocol used by clients and servers to talk to each other. It defines a way to bundle files and transfer them between computers.</p> <p>It is made up of <code>Requests</code> and <code>Responses</code>.</p> <p>Every <code>HTTP Request</code> and <code>HTTP Response</code> has a <code>Head</code>, a <code>Body</code>, and a <code>Footer</code>. We never see the footer. It is used to verify that things are reassembled properly and that no data is missing.</p> <p>The <code>Head</code> holds the meta information about the request or response. What address is it being sent from, what address it is being sent to, whether it is encrypted, what type of file is contained in the body, the file size of the body, the encoding type, if it is compressed, cookies, what is the expiry date of the response, and much more. All the values in the <code>Head</code> are called <code>Headers</code>.</p> <p>The <code>QueryString</code> is one of the <code>Headers</code>. It is a string that contains a series of name value pairs. There is an <code>=</code> sign between each name and value. And there is an <code>&amp;</code> ampersand between each of the pairs. The values in the <code>QueryString</code> need to be URL encoded to avoid causing issues with other programs, through special characters, who might read the string.</p> <p>The official object for a <code>QueryString</code> is a <a href="https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams" target="_blank" rel="noopener noreferrer">URLSearchParams<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> object.</p> <div title="encoding and decoding URIs" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/tmgMWWNRTp0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; fullscreen" allowfullscreen="allowfullscreen"></iframe></div> <p><code>Cookies</code> that we covered in week 2, are also one of the header values.</p> <p>The <code>Method</code> verb (GET, POST, PUT, PATCH, DELETE, HEAD, OPTIONS) is one of the <code>Headers</code>. The <code>Method</code> is important on the Server because it gives the server an idea of how to handle the request. You will learn more about this in MAD9124.</p> <p>The <code>Body</code> is the container for the file that is being uploaded or downloaded. The <code>Body</code> can be empty if there is no file or data being uploaded or downloaded. With a <code>GET</code> <code>Request</code> the <code>Body</code> is always empty.</p> <p>The two places that you can put information to send with a <code>Request</code> or <code>Response</code> are in the <code>QueryString</code> or in the <code>Body</code>. The <code>QueryString</code> is limited to about 2000 characters. The Body is limited in total size on most servers to files that are roughly 20MB. This limit can be changed through server-side settings.</p> <h3 id="request-objects"><a href="#request-objects" class="header-anchor">#</a> Request Objects</h3> <p>When you make a <code>fetch</code> call, very often you are only providing a URL to the method. However, the <code>fetch</code> method will actually create a <code>new Request()</code> object on your behalf, using all the default values plus your URL.</p> <p>If you need to you can create your own <code>Request</code> object.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//fetch also accepts a Request object instead of a URL object or URL string.</span>
<span class="token function">fetch</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">body</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>warn<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>Inside the Request object you can define what the headers are and what the body is.</p> <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Request" target="_blank" rel="noopener noreferrer">MDN reference for Request Object<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. You can use this reference to find all the properties and methods of a Request object.</p> <h3 id="response-objects"><a href="#response-objects" class="header-anchor">#</a> Response Objects</h3> <p>Typically you will be working with a response object that gets returned to the first <code>then</code> method after a <code>fetch</code>.</p> <p>If you need to, like in a Service Worker when you want to send something to the browser that you are creating in response to a request, you can create your own <code>Response</code> Object.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> response <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Response</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Response" target="_blank" rel="noopener noreferrer">MDN reference for a Response Object<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. You can use this reference page to find all the properties and methods for a Response Object.</p> <h3 id="body-objects"><a href="#body-objects" class="header-anchor">#</a> Body Objects</h3> <p>The Body object is the container for any file or large block of data being transferred between a client and a server. Both the <code>Response</code> and the <code>Request</code> objects have a <code>body</code> property that is used to access the Body object.</p> <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Response/body" target="_blank" rel="noopener noreferrer">MDN reference for the body property of the Response object<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>The <code>body</code> property can contain one of the following data types:</p> <ul><li><a href="https://developer.mozilla.org/en-US/docs/Web/API/Blob" target="_blank" rel="noopener noreferrer">Blob<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> - for binary files like images</li> <li><a href="https://developer.mozilla.org/en-US/docs/Web/API/BufferSource" target="_blank" rel="noopener noreferrer">BufferSource<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> - like an array of data but binary</li> <li><a href="https://developer.mozilla.org/en-US/docs/Web/API/FormData" target="_blank" rel="noopener noreferrer">FormData<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> - generally used for the information from a form</li> <li><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableStream" target="_blank" rel="noopener noreferrer">ReadableStream<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> - large chunk of text or numerical data</li> <li><a href="https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams" target="_blank" rel="noopener noreferrer">URLSearchParams<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> - Query String formatted string</li> <li><a href="https://developer.mozilla.org/en-US/docs/Web/API/USVString" target="_blank" rel="noopener noreferrer">USVString<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> - an encoded string</li></ul> <h3 id="json-text-and-blob-methods"><a href="#json-text-and-blob-methods" class="header-anchor">#</a> json(), text(), and blob() Methods</h3> <p>When a <code>Response</code> comes back to the browser, to either your main script or a service worker, the most common datatypes that we receive are:</p> <ul><li>a json file</li> <li>a text file (CSS, XML, or HTML)</li> <li>an image (Blob)</li></ul> <p>Because of that, there are three specific methods that we can use to extract the contents of those files, from the <code>body</code> of the <code>Response</code>. We use the <code>Response.json()</code> method to convert the contents of the JSON file into a JavaScript Object. We use the <code>Response.text()</code> method to read the contents of the CSS, XML, or HTML file into a string. We use the <code>Response.blob()</code> method to extract the binary data from a binary file (like an image) into a <code>Blob</code> object.</p> <p>All three of the methods are asynchronous and return a <code>Promise</code>. So, we use them inside a <code>then()</code> method and return the <code>Promise</code> that they create. That way it gets passed to the next <code>then()</code> in the chain. The next <code>then()</code> will receive the Object, String, or Binary content from the method.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">fetch</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">//only the first return actually runs</span>
    <span class="token keyword">return</span> response<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> response<span class="token punctuation">.</span><span class="token function">blob</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">body</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">//body is the formatted contents returned from one of those methods</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>If we want to use the Blob as the source for an image element on our page then we need to use the <code>URL.createObjectURL()</code> method.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'dynamicImage'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="header-objects"><a href="#header-objects" class="header-anchor">#</a> Header Objects</h3> <p>The Header object is like an array of name value pairs. Many of the headers will be created by the browser and sent automatically. These are values that you are not allowed to edit. Things like the ip address cannot be altered in your script.</p> <p><a href="https://developer.mozilla.org/en-US/docs/Glossary/Forbidden_header_name" target="_blank" rel="noopener noreferrer">List of restricted header names<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>In addition, you are not allowed to programmatically edit the <code>set-cookie</code> or <code>set-cookie2</code> headers in a <code>Response</code> object.</p> <p>The Header object has an <code>append</code> method that we can use to add or edit header values.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> h <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Headers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
h<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'content-type'</span><span class="token punctuation">,</span> <span class="token string">'application/json'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
h<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'content-length'</span><span class="token punctuation">,</span> <span class="token number">13234</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//file size in bytes</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>When we are uploading a file, it means that we are adding a file to the <code>Body</code> and we should include headers that indicate the type and size of the attached file.</p> <p><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers" target="_blank" rel="noopener noreferrer">Here is a list of possible headers<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>Many of the existing headers can also be accessed through the <code>.headers</code> property on the <code>Request</code> and <code>Response</code> objects and its <code>.get()</code> method.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  response<span class="token punctuation">.</span>headers<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'Content-Type'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  response<span class="token punctuation">.</span>headers<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'Content-Encoding'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  response<span class="token punctuation">.</span>headers<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'Age'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  response<span class="token punctuation">.</span>headers<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'Date'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  response<span class="token punctuation">.</span>headers<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'X-my-custom-header'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>The other methods on the Header object include <code>has()</code>, <code>entries()</code>, and <code>delete()</code>. <a href="https://developer.mozilla.org/en-US/docs/Web/API/Headers/get" target="_blank" rel="noopener noreferrer">Here is the link to the get method<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <blockquote><p>It is worth noting that not all headers are accessible through JavaScript. This is for security reasons. Some are not able to be changed or deleted through script and some are not allow to be read.</p></blockquote> <h3 id="url-and-location-objects"><a href="#url-and-location-objects" class="header-anchor">#</a> URL and Location Objects</h3> <p>URLs can be thought of as just strings but they do have clearly defined parts: the domain, the path, the hash, the querystring(search), the protocol, and the port.</p> <p>JavaScript has a top level object <code>window.location</code> that contains all these parts. If you <code>console.log</code> the location object you will see all the different components that make it up. One way that you could built a url is to take or create a <code>Location</code> object and set the values for its different components and then use the full value of the <code>href</code> property string.</p> <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Location" target="_blank" rel="noopener noreferrer">MDN reference for Location Object<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>Another approach is to use the <code>URL</code> object to create one. It takes two parameters that make it work a lot more like a typical development situation, where you have a base url and then an endpoint with or without a <code>QueryString</code>.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token constant">BASEURL</span> <span class="token operator">=</span> <span class="token string">'http://somedomain.com'</span><span class="token punctuation">;</span>
<span class="token comment">//a global variable that holds the base url for your API</span>

<span class="token keyword">let</span> endpoint <span class="token operator">=</span> <span class="token string">'/api/people/23?api-key=8768374823'</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span>endpoint<span class="token punctuation">,</span> <span class="token constant">BASEURL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//first we have a url object to pass to a Request or fetch call.</span>

<span class="token keyword">let</span> str <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//here we have a String built from the url object</span>

<span class="token keyword">let</span> req <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Request</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// or new Request(str)</span>
<span class="token comment">//here we have a Request object with the url inside it</span>

<span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resp</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//we can pass a url directly to fetch</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'fetch with url'</span><span class="token punctuation">,</span> resp<span class="token punctuation">.</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">fetch</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resp</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//we can pass the request object that was given a url or string</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'fetch with url in request'</span><span class="token punctuation">,</span> resp<span class="token punctuation">.</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">fetch</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resp</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//we can pass the string to the fetch</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'fetch with url as string'</span><span class="token punctuation">,</span> resp<span class="token punctuation">.</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>The URL property of a <code>Request</code> or <code>Location</code> object, just like the <code>URL</code> object itself has a bunch of properties that you can access to directly read the different parts of a URL. (Otherwise you would have to parse the string yourself.)</p> <ul><li><code>hash</code> is the part that begins with <code>#</code>.</li> <li><code>host</code> is a hostname with a port (if specified).</li> <li><code>hostname</code> is the host without the port.</li> <li><code>href</code> is the entire url string with all the parts.</li> <li><code>origin</code> includes the scheme, domain, and port.</li> <li><code>pathname</code> is the path and filename starting with <code>/</code>.</li> <li><code>port</code> is the port number part of the url. Eg: 80 or 5500.</li> <li><code>protocol</code> is the scheme, like <code>http:</code>, <code>ftp:</code>, <code>https:</code>, <code>blob:</code>, or <code>file:</code>.</li> <li><code>search</code> is the querystring for the url and is either an empty string or includes the <code>?</code> at the start.</li> <li><code>searchParams</code> is a read-only <code>SearchParams</code> object with the elements in the querystring.</li></ul> <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/URL" target="_blank" rel="noopener noreferrer">MDN reference for URL<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="formdata-objects"><a href="#formdata-objects" class="header-anchor">#</a> FormData Objects</h3> <p>The <code>FormData</code> object is a great way to bundle an entire HTML form, including any hidden input elements, into a format that can be set as the value for a <code>Request</code> <code>body</code>.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> myform <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'myform'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//a form element on the page</span>
<span class="token keyword">let</span> fd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span>myform<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//this will append all the name value pairs for the elements in the form.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>2 lines of code and your entire form is bundled and ready to be uploaded.</p> <div class="custom-block danger"><p class="custom-block-title">Important</p> <p>You must give each of your form input, select, and textarea elements a <code>name</code> attribute. Without the <code>name</code> attribute it will not get added to the FormData object.</p> <p>You should always do validation on the data and not blindly upload it.</p></div> <p>Now, you can also use the <code>FormData</code> object to bundle data that is not part of a form, or a mix of form data and other variables.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> fd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
fd<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
fd<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'email'</span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'email'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>This <code>FormData</code> object with the two name-value pairs can now be passed to the <code>body</code> property of a <code>Request</code> or options object for a <code>fetch</code> call.</p> <h3 id="urlsearchparams"><a href="#urlsearchparams" class="header-anchor">#</a> URLSearchParams</h3> <p>The <code>URLSearchParams</code> object is the object that can be used to hold or build a QueryString. It can also be used as an alternative to <code>FormData</code> when bundling data to upload to the server. It can be used as part of the URL, in the headers, or in the <code>body</code>.</p> <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams" target="_blank" rel="noopener noreferrer">MDN reference for URLSearchParams<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>It is named as <code>URLSearchParams</code> because it represents the value held in the <code>search</code> property of the <code>Location</code> object, which is the top-level object that holds all the information about the webpage's url, hash, protocol, port, domain, path, etc.</p> <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Location" target="_blank" rel="noopener noreferrer">MDN Location reference<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>It works much the same way as a <code>Headers</code> or <code>FormData</code> object do.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> search <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
search<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'key'</span><span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
search<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'Karim'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
search<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token string">'key'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>
search<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Karim</span>
search<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//sorts the existing values by their key</span>
search<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">val<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> val<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
search<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">'key'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
search<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//gives you the full string (without a `?`)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>There is also an <code>append</code> method that works like <code>set</code> but will allow for duplicate entries with the same key.</p> <p>It is an iterable object, which means it can be used in a <code>for...of</code> loop.</p> <p>When you want to add a <code>URLSearchParams</code> string to the URL or to the body, use the <code>toString</code> method. Remember to add the <code>?</code> in front of it if you are using it as part of the URL.</p> <h3 id="usvstring"><a href="#usvstring" class="header-anchor">#</a> USVString</h3> <p>A <code>USVString</code> is a Unicode Scalar Value String. Basically it is a string designed for efficient text processing. It uses UTF-16 instead of UTF-8 for the holding of string values. This means that code-points that need 16-bit values to be represented can be saved as a single character. Chinese characters and Emojis both fall into this category. JavaScript will internally handle the conversion between UTF-8 strings and UTF-16 strings when you use the <code>USVString</code>.</p> <p>When you see that a <code>USVString</code> is being used for an API, you can just think of it as a string that is encoded to work well in fetch calls and URLs.</p> <h2 id="fetch-all-together"><a href="#fetch-all-together" class="header-anchor">#</a> Fetch All Together</h2> <p>Now that you know all the parts of an <code>HTTP Request</code>, you can build your own <code>Request</code> object and pass it to a <code>fetch</code> call.</p> <p>The following example shows how to combine all the different parts into a Request object that gets passed to the <code>fetch</code> method. Only one value is being appended or added to the <code>Headers</code>, <code>FormData</code>, or <code>URLSearchParms</code> object for brevity's sake.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> head <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Headers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//`append` what you need</span>
head<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'x-custom-header'</span><span class="token punctuation">,</span> <span class="token string">'Memento'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> fd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//`append` what you need</span>
fd<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> search <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//`set` what you need</span>
search<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'api-key'</span><span class="token punctuation">,</span> <span class="token string">'some-value'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> baseURL <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">https://www.example.com</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token keyword">let</span> relativePath <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">./api/endpoint</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token keyword">let</span> url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>relativePath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">?</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>search<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> baseURL<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// or new URL(path+querystring, baseurl).toString();</span>
<span class="token comment">//call the toString method to create the DOMString to pass to the Request object</span>

<span class="token keyword">let</span> req <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Request</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  headers<span class="token operator">:</span> head<span class="token punctuation">,</span>
  method<span class="token operator">:</span> <span class="token string">'POST'</span><span class="token punctuation">,</span>
  mode<span class="token operator">:</span> <span class="token string">'cors'</span><span class="token punctuation">,</span>
  body<span class="token operator">:</span> fd<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">fetch</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">//response to the fetch</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h2 id="cors"><a href="#cors" class="header-anchor">#</a> CORS</h2> <p><strong>Cross-Origin Resource Sharing (CORS)</strong> is the name of a set of rules that Browsers use in determining whether assets from other origins or domains are safe to downloaded or use.</p> <p>There are Request headers and Response headers that are only allowed to be set by the browser or the server. There are others that we are allowed to dynamically create or edit with JavaScript.</p> <p>Sometimes a file can be fetched but we are not allowed to use the contents.</p> <p>There are special requests called <code>preflight</code> requests that are used to determine whether these rules are met.</p> <p><a href="./cors">Full explaination of CORS</a>. A summary of what CORS is can be found in the video below.</p> <div title="fetch cookies cors" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/34wC1C61lg0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; fullscreen" allowfullscreen="allowfullscreen"></iframe></div> <h2 id="content-security-policies"><a href="#content-security-policies" class="header-anchor">#</a> Content-Security-Policies</h2> <p>The <code>Content-Security-Policy</code> is a security feature in the browser that lets you add to the headers or the <code>&lt;meta&gt;</code> tags in your document head, a list of the locations that the website is allowed to use to find all the different parts of the page. For example, if you had one place for fonts, two places for images, three allowed servers for scripts, and one allowed server for fetch calls, then all that can be defined in the <code>Content-Security-Policy</code> header.</p> <p><a href="https://content-security-policy.com/" target="_blank" rel="noopener noreferrer">CSP official site<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div title="CSP meta tags" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/1-sx4AmjGCI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; fullscreen" allowfullscreen="allowfullscreen"></iframe></div> <h2 id="authentication-and-jwt"><a href="#authentication-and-jwt" class="header-anchor">#</a> Authentication and JWT</h2> <p>When you need to do things like pass a username and password along with a fetch request, there are a few things you can do.</p> <p>The following videos will be very useful to you later on when you start using JWT in MAD9124 and need to accept tokens on the client side.</p> <div title="Basic Authentication with Fetch" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/MvNT0Jis-3k" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; fullscreen" allowfullscreen="allowfullscreen"></iframe></div> <p>Tokens has become the most common way to authenticate with <code>fetch</code> and API calls. This first video explains how tokens can be passed through fetch.</p> <div title="Fetch with Tokens" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/Ju5FGcyifEA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; fullscreen" allowfullscreen="allowfullscreen"></iframe></div> <p>This next video shows the full life cycle of JWT (JavaScript Web Tokens) on the client and server. The Server-side part of this will be discussed in detail in MAD9124.</p> <div title="JWT lifecycle client and server" class="video-player"><iframe width="560" height="315" src="https://www.youtube.com/embed/QCCmWNlEkdY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; fullscreen" allowfullscreen="allowfullscreen"></iframe></div> <h2 id="what-to-do-this-week"><a href="#what-to-do-this-week" class="header-anchor">#</a> What to do this week</h2> <div class="custom-block warning"><p class="custom-block-title">TODO</p> <p>Things to do before next week</p> <ul><li>Read and Watch all the course content for <code>5.1</code>, <code>5.2</code>, and <code>6.1</code></li> <li>Start working on <a href="/W2022/assignments/hybrid/#_3-feature-branch-and-controls-part-2">Hybrid Three</a></li></ul></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2/9/2022, 11:56:53 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      
      <a href="/W2022/modules/week5/manifest-install/" class="prev">
        5.1: Web Manifests and PWA Installs
      </a></span> <span class="next"><a href="/W2022/modules/week6/caching/">
        6.1: Offline First and Audits
      </a>
      
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/W2022/assets/js/app.86fc79ff.js" defer></script><script src="/W2022/assets/js/2.644458f3.js" defer></script><script src="/W2022/assets/js/42.241ccad7.js" defer></script><script src="/W2022/assets/js/8.c8690475.js" defer></script><script src="/W2022/assets/js/10.e0709425.js" defer></script>
  </body>
</html>
