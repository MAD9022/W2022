<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>13.1 Data Persistence | MAD9022</title>
    <meta name="generator" content="VuePress 1.9.5">
    
    <meta name="description" content="Fullstack: Frontend Development Course">
    
    <link rel="preload" href="/W2022/assets/css/0.styles.e8f982fe.css" as="style"><link rel="preload" href="/W2022/assets/js/app.86fc79ff.js" as="script"><link rel="preload" href="/W2022/assets/js/2.644458f3.js" as="script"><link rel="preload" href="/W2022/assets/js/34.849cc443.js" as="script"><link rel="preload" href="/W2022/assets/js/8.c8690475.js" as="script"><link rel="prefetch" href="/W2022/assets/js/10.e0709425.js"><link rel="prefetch" href="/W2022/assets/js/11.03dd7ca9.js"><link rel="prefetch" href="/W2022/assets/js/12.099d5a86.js"><link rel="prefetch" href="/W2022/assets/js/13.2bd6007b.js"><link rel="prefetch" href="/W2022/assets/js/14.e0a43227.js"><link rel="prefetch" href="/W2022/assets/js/15.092d6948.js"><link rel="prefetch" href="/W2022/assets/js/16.859f074a.js"><link rel="prefetch" href="/W2022/assets/js/17.75c09ace.js"><link rel="prefetch" href="/W2022/assets/js/18.a6e526dd.js"><link rel="prefetch" href="/W2022/assets/js/19.bb7ee112.js"><link rel="prefetch" href="/W2022/assets/js/20.97f8b97a.js"><link rel="prefetch" href="/W2022/assets/js/21.23d3ef6f.js"><link rel="prefetch" href="/W2022/assets/js/22.933a5f9c.js"><link rel="prefetch" href="/W2022/assets/js/23.4a816fa9.js"><link rel="prefetch" href="/W2022/assets/js/24.4b4b432d.js"><link rel="prefetch" href="/W2022/assets/js/25.cd556980.js"><link rel="prefetch" href="/W2022/assets/js/26.ba97292d.js"><link rel="prefetch" href="/W2022/assets/js/27.cd63cd1f.js"><link rel="prefetch" href="/W2022/assets/js/28.7c415eed.js"><link rel="prefetch" href="/W2022/assets/js/29.cfd0de32.js"><link rel="prefetch" href="/W2022/assets/js/3.bca6a9a1.js"><link rel="prefetch" href="/W2022/assets/js/30.914c8d51.js"><link rel="prefetch" href="/W2022/assets/js/31.7bc52ca8.js"><link rel="prefetch" href="/W2022/assets/js/32.e7e81d1c.js"><link rel="prefetch" href="/W2022/assets/js/33.b0178163.js"><link rel="prefetch" href="/W2022/assets/js/35.37fdb7ab.js"><link rel="prefetch" href="/W2022/assets/js/36.0c0d987a.js"><link rel="prefetch" href="/W2022/assets/js/37.be9d0dcc.js"><link rel="prefetch" href="/W2022/assets/js/38.1c08ef56.js"><link rel="prefetch" href="/W2022/assets/js/39.10bff2ae.js"><link rel="prefetch" href="/W2022/assets/js/4.e2498dd6.js"><link rel="prefetch" href="/W2022/assets/js/40.8fe54bd5.js"><link rel="prefetch" href="/W2022/assets/js/41.42838ccb.js"><link rel="prefetch" href="/W2022/assets/js/42.241ccad7.js"><link rel="prefetch" href="/W2022/assets/js/43.458ecccd.js"><link rel="prefetch" href="/W2022/assets/js/44.07fdfe33.js"><link rel="prefetch" href="/W2022/assets/js/45.2da207c2.js"><link rel="prefetch" href="/W2022/assets/js/46.51fffa86.js"><link rel="prefetch" href="/W2022/assets/js/47.65aed37a.js"><link rel="prefetch" href="/W2022/assets/js/5.02d60a9c.js"><link rel="prefetch" href="/W2022/assets/js/6.40785f8b.js"><link rel="prefetch" href="/W2022/assets/js/7.c2b7ff19.js"><link rel="prefetch" href="/W2022/assets/js/9.ec48c5f9.js">
    <link rel="stylesheet" href="/W2022/assets/css/0.styles.e8f982fe.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/W2022/" class="home-link router-link-active"><!----> <span class="site-name">MAD9022</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/W2022/overview/" class="nav-link">
  Overview
</a></div><div class="nav-item"><a href="/W2022/assignments/" class="nav-link">
  Deliverables
</a></div><div class="nav-item"><a href="/W2022/resources/" class="nav-link">
  Resources
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/W2022/overview/" class="nav-link">
  Overview
</a></div><div class="nav-item"><a href="/W2022/assignments/" class="nav-link">
  Deliverables
</a></div><div class="nav-item"><a href="/W2022/resources/" class="nav-link">
  Resources
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Introduction</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Content Modules</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/W2022/modules/week1/file-formats/" class="sidebar-link">1.1: File Formats</a></li><li><a href="/W2022/modules/week1/data-structures/" class="sidebar-link">1.2: Data Structures</a></li><li><a href="/W2022/modules/week2/cookie-webstorage/" class="sidebar-link">2.1: Cookies, LocalStorage, Cache</a></li><li><a href="/W2022/modules/week2/indexeddb/" class="sidebar-link">2.2: IndexedDB</a></li><li><a href="/W2022/modules/week3/code-organizing/" class="sidebar-link">3.1: ES Modules</a></li><li><a href="/W2022/modules/week3/continuous-delivery/" class="sidebar-link">3.2: Github and Netlify</a></li><li><a href="/W2022/modules/week4/web-workers/" class="sidebar-link">4.1: Asynchronous Code &amp; Workers</a></li><li><a href="/W2022/modules/week4/service-workers/" class="sidebar-link">4.2: Service Workers</a></li><li><a href="/W2022/modules/week5/manifest-install/" class="sidebar-link">5.1: Web Manifests and PWA Installs</a></li><li><a href="/W2022/modules/week5/api-fetch/" class="sidebar-link">5.2: APIs and Fetch</a></li><li><a href="/W2022/modules/week6/caching/" class="sidebar-link">6.1: Offline First and Audits</a></li><li><a href="/W2022/modules/week6/install-native/" class="sidebar-link">6.2: More PWA Stuff</a></li><li><a href="/W2022/modules/week7/pwa-project/" class="sidebar-link">7.2: PWA Project</a></li><li><a href="/W2022/modules/reading/" class="sidebar-link">Reading Week</a></li><li><a href="/W2022/modules/week9/flutter-setup/" class="sidebar-link">9.1: Flutter Setup</a></li><li><a href="/W2022/modules/week9/flutter-intro/" class="sidebar-link">9.2: Flutter Intro</a></li><li><a href="/W2022/modules/week10/colors-assets/" class="sidebar-link">10.1: Using Colors and Assets in Widgets</a></li><li><a href="/W2022/modules/week10/layout-widgets/" class="sidebar-link">10.2: Flutter Layout and Widgets</a></li><li><a href="/W2022/modules/week11/navigation/" class="sidebar-link">11.1: Flutter Navigation</a></li><li><a href="/W2022/modules/week11/stateful/" class="sidebar-link">11.2: Stateful Widgets</a></li><li><a href="/W2022/modules/week12/api-1/" class="sidebar-link">12.1: Flutter API Calls I</a></li><li><a href="/W2022/modules/week12/api-2/" class="sidebar-link">12.2: Flutter API Calls II</a></li><li><a href="/W2022/modules/week13/data-persistence/" aria-current="page" class="active sidebar-link">13.1: Shared Preferences</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/W2022/modules/week13/data-persistence/#shared-preferences" class="sidebar-link">Shared Preferences</a></li><li class="sidebar-sub-header"><a href="/W2022/modules/week13/data-persistence/#shared-preferences-solution" class="sidebar-link">Shared Preferences Solution</a></li><li class="sidebar-sub-header"><a href="/W2022/modules/week13/data-persistence/#random-numbers-in-dart" class="sidebar-link">Random Numbers in Dart</a></li><li class="sidebar-sub-header"><a href="/W2022/modules/week13/data-persistence/#js-array-map-and-filter-method-equivalencies" class="sidebar-link">JS Array map and filter method Equivalencies</a></li><li class="sidebar-sub-header"><a href="/W2022/modules/week13/data-persistence/#path-provider" class="sidebar-link">Path Provider</a></li><li class="sidebar-sub-header"><a href="/W2022/modules/week13/data-persistence/#advice-for-final-project" class="sidebar-link">Advice for Final Project</a></li><li class="sidebar-sub-header"><a href="/W2022/modules/week13/data-persistence/#what-to-do-this-week" class="sidebar-link">What to do this week</a></li></ul></li><li><a href="/W2022/modules/week13/themes/" class="sidebar-link">13.2: Themes, Splash Screens, More</a></li><li><a href="/W2022/modules/week14/" class="sidebar-link">14: Gestures, Dismissable, More</a></li><li><a href="/W2022/modules/week15/" class="sidebar-link">15: Final Project</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Deliverables</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><header><div class="section-title gold">
    Flutter Apps
  </div> <h1>13.1 Data Persistence</h1></header> <h2 id="shared-preferences"><a href="#shared-preferences" class="header-anchor">#</a> Shared Preferences</h2> <p><code>SharedPreferences</code> in Flutter are a lot like <code>LocalStorage</code> in the browser. You create a String key for each value you want to save and then save a value associated with that key.</p> <p>The primary differences are:</p> <ul><li>that you don't have to worry about other apps or webpages interfering with your key names because all the values are connected to your app and the code that you are writing.</li> <li>When you save or retrieve the value, you need to know what the datatype is for the information that you are saving.</li> <li>The read write operations for <code>SharedPreferences</code> are asynchronous so we need to use <code>Future</code> and possibly <code>async</code> and <code>await</code>.</li></ul> <p>To use <code>SharedPreferences</code> we need to import the dart package <a href="https://pub.dev/packages/shared_preferences" target="_blank" rel="noopener noreferrer">shared_preferences from pub.dev<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>Add <code>shared_preferences: ^2.0.13</code> to your <code>pubspec.yaml</code> dependencies list and run <code>flutter pub get</code> (if VSCode does not run it for you).</p> <p>Then you can import it at the top of any file that needs it.</p> <div class="language-dart line-numbers-mode"><pre class="language-dart"><code><span class="token keyword">import</span> <span class="token string">'package:shared_preferences/shared_preferences.dart'</span><span class="token punctuation">;</span>

<span class="token comment">//inside an async function we will access the SharedPreferences storage for our app</span>
<span class="token keyword">final</span> prefs <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token class-name">SharedPreferences</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>Here is the <a href="https://pub.dev/documentation/shared_preferences/latest/" target="_blank" rel="noopener noreferrer">shared_preferences reference<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>Once you have a reference to the <code>SharedPreferences</code> storage instance for your app then you can start saving data. The data that you save must be one of the following types: boolean, string, integer, double, or List of Strings.</p> <div class="language-dart line-numbers-mode"><pre class="language-dart"><code><span class="token comment">//To SAVE values use these methods</span>
<span class="token comment">// Save an integer value to 'counter' key.</span>
<span class="token keyword">await</span> prefs<span class="token punctuation">.</span><span class="token function">setInt</span><span class="token punctuation">(</span><span class="token string">'counter'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Save an boolean value to 'repeat' key.</span>
<span class="token keyword">await</span> prefs<span class="token punctuation">.</span><span class="token function">setBool</span><span class="token punctuation">(</span><span class="token string">'repeat'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Save an double value to 'decimal' key.</span>
<span class="token keyword">await</span> prefs<span class="token punctuation">.</span><span class="token function">setDouble</span><span class="token punctuation">(</span><span class="token string">'decimal'</span><span class="token punctuation">,</span> <span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Save an String value to 'action' key.</span>
<span class="token keyword">await</span> prefs<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token string">'action'</span><span class="token punctuation">,</span> <span class="token string">'Start'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Save an list of strings to 'items' key.</span>
<span class="token keyword">await</span> prefs<span class="token punctuation">.</span><span class="token function">setStringList</span><span class="token punctuation">(</span><span class="token string">'items'</span><span class="token punctuation">,</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token string">'Earth'</span><span class="token punctuation">,</span> <span class="token string">'Moon'</span><span class="token punctuation">,</span> <span class="token string">'Sun'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>To read the values from your <code>SharedPreferences</code> instance</p> <div class="language-dart line-numbers-mode"><pre class="language-dart"><code><span class="token comment">// Try reading data from the 'counter' key. If it doesn't exist, returns null.</span>
<span class="token keyword">final</span> int<span class="token operator">?</span> counter <span class="token operator">=</span> prefs<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">'counter'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Try reading data from the 'repeat' key. If it doesn't exist, returns null.</span>
<span class="token keyword">final</span> bool<span class="token operator">?</span> repeat <span class="token operator">=</span> prefs<span class="token punctuation">.</span><span class="token function">getBool</span><span class="token punctuation">(</span><span class="token string">'repeat'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Try reading data from the 'decimal' key. If it doesn't exist, returns null.</span>
<span class="token keyword">final</span> double<span class="token operator">?</span> decimal <span class="token operator">=</span> prefs<span class="token punctuation">.</span><span class="token function">getDouble</span><span class="token punctuation">(</span><span class="token string">'decimal'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Try reading data from the 'action' key. If it doesn't exist, returns null.</span>
<span class="token keyword">final</span> <span class="token class-name">String</span><span class="token operator">?</span> action <span class="token operator">=</span> prefs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">'action'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Try reading data from the 'items' key. If it doesn't exist, returns null.</span>
<span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token operator">?</span> items <span class="token operator">=</span> prefs<span class="token punctuation">.</span><span class="token function">getStringList</span><span class="token punctuation">(</span><span class="token string">'items'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>To remove an entry from your <code>SharedPreferences</code> instance, use the <code>remove</code> method.</p> <div class="language-dart line-numbers-mode"><pre class="language-dart"><code><span class="token comment">// Remove data for the 'counter' key.</span>
<span class="token keyword">final</span> success <span class="token operator">=</span> <span class="token keyword">await</span> prefs<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token string">'counter'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>It is worth noting that the write and delete methods are asynchronous and require the <code>await</code> keyword, but the read methods do not.</p> <p>But, what about my big chunk of JSON, you ask? What if I have an array of numbers plus a whole host of other properties that I need to save?</p> <p>The answer comes from the fact that JSON is already a String. If the data came from an API as a JSON String then you can simply use the <code>await prefs.setString()</code> method.</p> <p>If you have data that you have gathered from other locations, like a form, and you want to save that information in <code>SharedPreferences</code>, then you can put all your information into a <code>Map</code> and convert that <code>Map</code> into a JSON String using the <code>dart:convert</code> package.</p> <div class="language-dart line-numbers-mode"><pre class="language-dart"><code><span class="token keyword">import</span> <span class="token string">'package:shared_preferences/shared_preferences.dart'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'data:convert'</span><span class="token punctuation">;</span>

<span class="token class-name">String</span> convertToJsonAndSave <span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">String</span> name<span class="token punctuation">,</span> int id<span class="token punctuation">,</span> <span class="token class-name">String</span> email<span class="token punctuation">)</span> <span class="token keyword">async</span><span class="token punctuation">{</span>
  <span class="token comment">//pass in the values you want to save as a JSON string</span>
  <span class="token comment">//plus a key to use for your saved data in SharedPreferences</span>
  <span class="token comment">//access the Shared Preferences instance for your app</span>
  <span class="token keyword">final</span> prefs <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token class-name">SharedPreferences</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">//build the map to hold the parameters passed to the function</span>
  <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token keyword">dynamic</span><span class="token punctuation">&gt;</span></span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'id'</span><span class="token punctuation">:</span> id<span class="token punctuation">,</span>
    <span class="token string">'name'</span><span class="token punctuation">:</span> name<span class="token punctuation">,</span>
    <span class="token string">'email'</span><span class="token punctuation">:</span> email<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token comment">//convert the Map to a JSON string</span>
  <span class="token class-name">String</span> jsonStr <span class="token operator">=</span> json<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//write the String to SharedPreferences</span>
  <span class="token keyword">await</span> prefs<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> jsonStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//return the saved string in case it is needed elsewhere</span>
  <span class="token keyword">return</span> jsonStr<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="shared-preferences-solution"><a href="#shared-preferences-solution" class="header-anchor">#</a> Shared Preferences Solution</h2> <p>Here is the repo <a href="https://github.com/prof3ssorSt3v3/Flutter-Shared-Pref" target="_blank" rel="noopener noreferrer">showing examples of connecting logins with SharedPreferences<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. The example repo shows logging in, getting a token, saving the token in SharedPreferences, and navigating between screens when logged in or logged out. The login and navigating steps are split into separate buttons just to show the effects on the screens. In a real app you would be combining this functionality into a single button click.</p> <h2 id="random-numbers-in-dart"><a href="#random-numbers-in-dart" class="header-anchor">#</a> Random Numbers in Dart</h2> <p>In dart, when you want to create random values then you need to import the <code>dart:math</code> package. After that you will use the <code>Random()</code> class constructor to create a random value generator. You can optionally pass a unique seed value to the <code>Random</code> constructor. With the generator created you can call <code>nextInt()</code> or <code>nextDouble()</code> or <code>nextBool()</code> to get a random integer, double, or boolean value. For <code>nextInt</code> and <code>nextDouble</code> you can pass in a max value. The random number will be from zero, up to but not including your max value.</p> <p>If you want to improve the randomness you can use the named constructor <code>Random.secure()</code> instead.</p> <div class="language-dart line-numbers-mode"><pre class="language-dart"><code><span class="token keyword">import</span> <span class="token string">'dart:math'</span><span class="token punctuation">;</span>

<span class="token comment">//pick a random name from a list.</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Tony'</span><span class="token punctuation">,</span> <span class="token string">'Robert'</span><span class="token punctuation">,</span> <span class="token string">'SuCheng'</span><span class="token punctuation">,</span> <span class="token string">'Steve'</span><span class="token punctuation">,</span> <span class="token string">'David'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

int seed <span class="token operator">=</span> <span class="token number">3661</span><span class="token punctuation">;</span>
int index <span class="token operator">=</span> <span class="token class-name">Random</span><span class="token punctuation">(</span>seed<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span>names<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">String</span> randomName <span class="token operator">=</span> name<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="js-array-map-and-filter-method-equivalencies"><a href="#js-array-map-and-filter-method-equivalencies" class="header-anchor">#</a> JS Array map and filter method Equivalencies</h2> <p>In Javascript, we have a number of Array methods that we use to manipulate arrays of objects that we get from API calls that return JSON. Dart has many methods on it's <code>List</code> object that do the same things. <a href="https://api.dart.dev/stable/2.16.2/dart-core/List-class.html" target="_blank" rel="noopener noreferrer">Dart Reference for List objects<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>In Javascript, the two most common methods are <code>map</code> and <code>filter</code>. <code>map</code> returns a new Array that has the same length as the original. It allows us to modify the objects that are inside, usually reducing the size of the original objects. The <code>filter</code> method allows us to remove one or more unwanted objects from the original array and create a new modified Array. Both methods achieve this by calling a function on each of the elements in the Array and returning a new element (for map) or true | false (for filter) to decide whether to keep the old element.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//map example creating a new Array with new objects</span>
<span class="token comment">//that are a copy of the old objects with a new property</span>
<span class="token keyword">let</span> newArr <span class="token operator">=</span> oldArr<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">element</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> newElement <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>element <span class="token punctuation">}</span><span class="token punctuation">;</span>
  newElement<span class="token punctuation">.</span>newProp <span class="token operator">=</span> <span class="token string">'hello'</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> newElement<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//filter example creating a new Array that copies the old Array except</span>
<span class="token comment">//that the element with the id 5 has been removed.</span>
<span class="token keyword">let</span> idToMatch <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> newArr <span class="token operator">=</span> oldArr<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">element</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> element<span class="token punctuation">.</span>id <span class="token operator">!=</span> idToMatch<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>And here are the dart equivalents to the JS methods above, using <code>map</code> and <code>where</code>.</p> <div class="language-dart line-numbers-mode"><pre class="language-dart"><code><span class="token class-name">List</span> newArr <span class="token operator">=</span> oldArr<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token keyword">dynamic</span><span class="token punctuation">&gt;</span></span> newElement <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>element<span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">//destructuring works here too</span>
  newElement<span class="token punctuation">[</span><span class="token string">'newProp'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'hello'</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> newElement<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

int idToMatch <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
<span class="token class-name">List</span> newArr <span class="token operator">=</span> oldArr<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> element<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span> <span class="token operator">!=</span> idToMatch<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><blockquote><p>NB: The dart methods must have the <code>.toList</code> method at the end to create the new list.</p></blockquote> <p>Both dart <code>List</code> objects and Javascript <code>Array</code> objects have a <code>forEach</code> method too.</p> <h2 id="path-provider"><a href="#path-provider" class="header-anchor">#</a> Path Provider</h2> <p>Getting the location of files that are saved on the device requires knowing about two folders - the temp folder and the app document directory. The pub.dev package <code>path_provider</code> can get us these two locations. We will also need the <code>dart:io</code> package to be imported.</p> <div class="language-dart line-numbers-mode"><pre class="language-dart"><code><span class="token keyword">import</span> <span class="token string">'dart:io'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'package:path_provider/path_provider.dart'</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">_getFolders</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token class-name">Directory</span> tempDir <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getTemporaryDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">Directory</span> appDocDir <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getApplicationDocumentDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">String</span> tempPath <span class="token operator">=</span> tempDir<span class="token punctuation">.</span>path<span class="token punctuation">;</span>
  <span class="token class-name">String</span> appDocPath <span class="token operator">=</span> appDocDir<span class="token punctuation">.</span>path<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>A useful application of the <code>path</code> and <code>path_provider</code> packages is the ability to take pictures and save them in an app folder. The Flutter Cookbook section has a recipe on how to do this. <a href="https://docs.flutter.dev/cookbook/plugins/picture-using-camera" target="_blank" rel="noopener noreferrer">Cookbook Recipe for Camera<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h2 id="advice-for-final-project"><a href="#advice-for-final-project" class="header-anchor">#</a> Advice for Final Project</h2> <div class="custom-block tip"><p class="custom-block-title">Final Project and Git</p> <ul><li>One partner will create the private repo and then invite their partner as a collaborator.</li> <li>Remember to use GitHub as the way to share code with your partner.</li> <li>Remember to set up the <code>Settings &gt; Branches &gt; rules</code> to require pull requests when merging into main.</li> <li>Since only one person will own the repo. The owner will be responsible for doing the merge of every pull request.</li> <li>The main branch is the starting point. Each time you want to add to the project, create your own new branch with <code>git checkout -b myNewBranch</code>.</li> <li>When your code for a feature is ready, do a pull request and merge it back into the main branch on GitHub.</li></ul></div> <h2 id="what-to-do-this-week"><a href="#what-to-do-this-week" class="header-anchor">#</a> What to do this week</h2> <div class="custom-block warning"><p class="custom-block-title">TODO</p> <p>Things to do before next week</p> <ul><li>Finish your <a href="/W2022/assignments/hybrid/">Hybrid step six assignment</a></li> <li>Work with your partner to start planning the screens for your <a href="/W2022/assignments/projects/">Flutter Final Project</a></li></ul></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">3/30/2022, 10:04:36 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/W2022/modules/week12/api-2/" class="prev">
        12.2: Flutter API Calls II
      </a></span> <span class="next"><a href="/W2022/modules/week13/themes/">
        13.2: Themes, Splash Screens, More
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/W2022/assets/js/app.86fc79ff.js" defer></script><script src="/W2022/assets/js/2.644458f3.js" defer></script><script src="/W2022/assets/js/34.849cc443.js" defer></script><script src="/W2022/assets/js/8.c8690475.js" defer></script>
  </body>
</html>
